<!DOCTYPE html>
<html lang="pt-BR" layout:decorate="~{layout}">

<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" th:href="@{/plugins/select2/css/select2.min.css}">
    <link rel="stylesheet" th:href="@{/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css}">
</head>

<body class="hold-transition sidebar-mini">


    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper pb-3" layout:fragment="corpo">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-6 d-flex align-items-center">
                        <img th:src="@{/assets/images/pcma-logo.png}" alt="pcma-logo.png" class="mr-2" width="50px">
                        <h1>Pesquisa de Satisfação | Polícia Civil</h1>
                    </div>
                    <!-- <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a href="#">Home</a></li>
                                <li class="breadcrumb-item active">Project Add</li>
                            </ol>
                        </div> -->
                </div>
            </div>
        </section>

        <!-- Main content -->
        <section class="content">
            <form th:action="@{/salvar}" method="post" th:object="${pesquisa}" id="pesquisa" class="needs-validation"
                novalidate onsubmit="return validarForm(this)">
                <div class="form-row">
                    <div class="col-12">
                        <!-- Dados Pessoais Optativos -->
                        <div class="card card-primary">
                            <div class="card-header">
                                <h3 class="card-title">Dados Pessoais (Optativo)</h3>

                                <div class="card-tools">
                                    <button type="button" class="btn btn-tool" data-card-widget="collapse"
                                        title="Collapse">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Nome, Idade e Sexo -->
                                <div class="form-row">
                                    <!-- Nome -->
                                    <div class="col-12 col-md-4">
                                        <div class="form-group">
                                            <label for="nome">Nome</label>
                                            <input type="text" id="nome" name="nome" class="form-control"
                                                placeholder="Nome completo" th:text="${nome}">
                                        </div>
                                    </div>

                                    <!-- Idade -->
                                    <div class="col-6 col-md-4">
                                        <div class="form-group">
                                            <label for="idade">Idade</label>
                                            <input type="number" id="idade" name="idade" class="form-control"
                                                data-mask="00" placeholder="Idade" min="0" max="120" th:text="${idade}">
                                        </div>
                                    </div>

                                    <!-- Nome -->
                                    <div class="col-6 col-md-4">
                                        <div class="form-group">
                                            <label for="sexo">Sexo</label>
                                            <select id="sexo" name="sexo" class="form-control custom-select"
                                                th:select="${sexo}">
                                                <option selected disabled>Selecione</option>
                                                <option>Masculino</option>
                                                <option>Feminino</option>
                                            </select>
                                        </div>
                                    </div>

                                </div>

                                <!-- CPF e Telefone -->
                                <div class="form-row">
                                    <div class="col-6">
                                        <!-- CPF -->
                                        <div class="form-group">
                                            <label for="cpf">CPF</label>
                                            <input type="text" id="cpf" name="cpf" class="form-control invalid"
                                                data-mask="000.000.000-00" placeholder="Ex.:000.000.000-00" min="0"
                                                th:text="${cpf}" />
                                        </div>
                                    </div>

                                    <div class="col-6">
                                        <!-- Telefone -->
                                        <div class="form-group">
                                            <label for="telefone">Telefone</label>
                                            <input type="tel" id="telefone" name="telefone" class="form-control"
                                                data-mask="(00) 00000-0000" placeholder="Ex.: (00) 0000-0000" min="0"
                                                th:text="${telefone}">
                                        </div>
                                    </div>
                                </div>

                                <!-- E-mail -->
                                <div class="form-row">
                                    <div class="col-12">
                                        <!-- E-mail -->
                                        <div class="form-group">
                                            <label for="e-mail">E-mail</label>
                                            <input type="email" id="email" name="email" class="form-control"
                                                placeholder="exemplo@xxxxx.com" th:text="${email}">
                                        </div>
                                    </div>
                                </div>

                                <!-- Pessoa com Deficiencia -->
                                <div class="form-row">
                                    <div class="col-12">
                                        <!-- Pessoa com Deficiencia -->
                                        <div class="form-group">
                                            <label for="deficiencia">Pessoa com Deficiencia</label>
                                            <select id="deficiencia" name="deficiencia"
                                                class="form-control custom-select" th:select="${deficiencia}">
                                                <option selected disabled>Selecione</option>
                                                <option>Sim</option>
                                                <option>Não</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Comunidade LGBTQIA+ -->
                                <div class="form-row">
                                    <div class="col-12">
                                        <!-- Comunidade LGBTQIA+ -->
                                        <div class="form-group">
                                            <label for="lgbt">Comunidade LGBTQIA+</label>
                                            <select id="lgbt" name="lgbt" class="form-control custom-select"
                                                th:select="${lgbt}">
                                                <option selected disabled>Selecione</option>
                                                <option>Sim</option>
                                                <option>Não</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Informações sobre o Atendimento -->
                        <div class="card card-primary">
                            <div class="card-header">
                                <h3 class="card-title">Informações sobre o Atendimento</h3>

                                <div class="card-tools">
                                    <button type="button" class="btn btn-tool" data-card-widget="collapse"
                                        title="Collapse">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Local de Atendimento -->
                                <div class="form-row">
                                    <!-- Local de Atendimento -->
                                    <div class="col-12">
                                        <div class="form-group">
                                            <label for="nome_local">Local de Atendimento <small
                                                    class="text-danger">(obrigatório)</small></label>
                                            <select id="nome_local" name="nome_local" class="form-control custom-select"
                                                th:select="${nome_local}" required>
                                                <option value="" selected disabled>Selecione</option>
                                                <option value="Delegacia de São Luís">Delegacia de São Luís</option>
                                                <option value="Delegacia de Timon">Delegacia de Timon</option>
                                                <option value="Delegacia de Imperatriz">Delegacia de Imperatriz</option>
                                                <option value="Delegacia de Santa Inês">Delegacia de Santa Inês</option>
                                            </select>
                                            <div class="valid-feedback">Tudo ok!</div>
                                            <div class="invalid-feedback">Selecione o Local de Atendimento!</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Data do Atendimento -->
                                <div class="form-row">
                                    <div class="col-12">
                                        <!-- Data do Atendimento -->
                                        <div class="form-group">
                                            <label for="data_atendimento">Data do Atendimento</label>
                                            <input type="date" id="data_atendimento" name="data_atendimento"
                                                class="form-control" placeholder="Nome do Atendente"
                                                th:date="${data_atendimento}">
                                        </div>
                                    </div>
                                </div>

                                <!-- Nome do Atendente -->
                                <div class="form-row">
                                    <div class="col-12">
                                        <!-- Nome do Atendente -->
                                        <div class="form-group">
                                            <label for="nome_atendente">Nome do Atendente</label>
                                            <input type="text" id="nome_atendente" name="nome_atendente"
                                                class="form-control" placeholder="Nome do Atendente"
                                                th:text="${nome_atendente}">
                                        </div>
                                    </div>
                                </div>

                                <!-- Cargo -->
                                <div class="form-row">
                                    <!-- Cargo -->
                                    <div class="col-12">
                                        <div class="form-group">
                                            <label for="nome_cargo">Cargo</label>
                                            <select id="nome_cargo" name="nome_cargo" class="form-control custom-select"
                                                th:select="${nome_cargo}">
                                                <option selected disabled>Selecione</option>
                                                <option>Administrativo</option>
                                                <option>Comissionados</option>
                                                <option>Delegado</option>
                                                <option>Escrivão</option>
                                                <option>Estagiário</option>
                                                <option>Investigador</option>
                                                <option>Serviços Gerais</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Serviço -->
                                <div class="form-row">
                                    <!-- Serviço -->
                                    <div class="col-12">
                                        <div class="form-group">
                                            <label for="nome_servico">Serviço <small
                                                    class="text-danger">(obrigatório)</small></label>
                                            <select id="nome_servico" name="nome_servico"
                                                class="form-control custom-select" th:select="${nome_servico}" required>
                                                <option value="" selected disabled>Selecione</option>
                                                <option value="Acompanhamento de Processos">Acompanhamento de Processos
                                                </option>
                                                <option value="Registro de Ocorrência">Registro de Ocorrência</option>
                                                <option value="Consultas Jurídicas">Consultas Jurídicas</option>
                                                <option value="Assitência Policial">Assitência Policial</option>
                                                <option value="Outros">Outros</option>
                                                <div class="valid-feedback">Tudo ok!</div>
                                                <div class="invalid-feedback">Selecione o Serviço Prestado</div>
                                            </select>
                                            <div class="valid-feedback">Tudo ok!</div>
                                            <div class="invalid-feedback">Selecione o Serviço Prestado</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Numero do BO e Ano do BO -->
                                <div class="row sr-only" id="numeroAnoBo">
                                    <div class="col-8">
                                        <!-- Numero do BO -->
                                        <div class="form-group">
                                            <label for="numero_bo">Número do BO</label>
                                            <input type="number" id="numero_bo" name="numero_bo" class="form-control"
                                                placeholder="Número sem o ano" min="0" th:text="${numero_bo}">
                                        </div>
                                    </div>

                                    <div class="col-4">
                                        <!-- Ano -->
                                        <div class="form-group">
                                            <label for="ano_bo">Ano</label>
                                            <input type="number" id="ano_bo" name="ano_bo" class="form-control"
                                                placeholder="Ano" data-mask="0000" min="0" max="2022"
                                                th:text="${ano_bo}">
                                        </div>
                                    </div>
                                </div>

                                <!-- Período de Atendimento -->
                                <div class="form-row">
                                    <!-- Período de Atendimento -->
                                    <div class="col-12">
                                        <div class="form-group">
                                            <label for="periodo">Período de Atendimento <small
                                                    class="text-danger">(obrigatório)</small></label>
                                            <select id="periodo" name="periodo" class="form-control custom-select"
                                                th:select="${periodo}" required>
                                                <option value="" selected disabled>Selecione</option>
                                                <option value="Matutino">Matutino</option>
                                                <option value="Vespertino">Vespertino</option>
                                                <option value="Noturno">Noturno</option>
                                                <option value="Madrugada">Madrugada</option>
                                            </select>
                                            <div class="valid-feedback">Tudo ok!</div>
                                            <div class="invalid-feedback">Selecione o Período do Atendimento</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Avaliação -->
                                <div class="form-row">
                                    <div class="col-12">
                                        <!-- Avaliação -->
                                        <div class="">
                                            <label for="numero-bo">Avaliação <small
                                                    class="text-danger">(obrigatório)</small></label>
                                        </div>
                                        <div class="form-group d-flex justify-content-around justify-content-md-start m-0"
                                            style="font-size: 1.2rem;">
                                            <label class="row" for="avaliacao-otimo" role="button"
                                                id="row-avaliacao-otimo" onclick="setAvaliacao(5)">
                                                <div class="col-12 text-center"><i id="icon-avaliacao-otimo"
                                                        class="far fa-laugh"></i></div>
                                                <div class="col-12 text-center">Ótimo</div>
                                            </label>

                                            <label class="row" for="avaliacao-bom" role="button" id="row-avaliacao-bom"
                                                onclick="setAvaliacao(4)">
                                                <div class="col-12 text-center"><i id="icon-avaliacao-bom"
                                                        class="far fa-smile"></i></div>
                                                <div class="col-12 text-center">Bom</div>
                                            </label>

                                            <label class="row" for="avaliacao-regular" role="button"
                                                id="row-avaliacao-regular" onclick="setAvaliacao(3)">
                                                <div class="col-12 text-center"><i id="icon-avaliacao-regular"
                                                        class="far fa-meh"></i></div>
                                                <div class="col-12 text-center">Regular</div>
                                            </label>

                                            <label class="row" for="avaliacao-ruim" role="button"
                                                id="row-avaliacao-ruim" onclick="setAvaliacao(2)">
                                                <div class="col-12 text-center"><i id="icon-avaliacao-ruim"
                                                        class="far fa-frown-open"></i></div>
                                                <div class="col-12 text-center">Ruim</div>
                                            </label>

                                            <label class="row" for="avaliacao-pessimo" role="button"
                                                id="row-avaliacao-pessimo" onclick="setAvaliacao(1)">
                                                <div class="col-12 text-center"><i id="icon-avaliacao-pessimo"
                                                        class="far fa-angry"></i></div>
                                                <div class="col-12 text-center">Péssimo</div>
                                            </label>
                                        </div>
                                        <!-- Radios da Avaliacao ocultos -->
                                        <div class="">
                                            <input type="radio" name="avaliacao" th:value="5" th:text="${avaliacao}"
                                                id="avaliacao-otimo" required class="sr-only">
                                            <input type="radio" name="avaliacao" th:value="4" th:text="${avaliacao}"
                                                id="avaliacao-bom" required class="sr-only">
                                            <input type="radio" name="avaliacao" th:value="3" th:text="${avaliacao}"
                                                id="avaliacao-regular" required class="sr-only">
                                            <input type="radio" name="avaliacao" th:value="2" th:text="${avaliacao}"
                                                id="avaliacao-ruim" required class="sr-only">
                                            <input type="radio" name="avaliacao" th:value="1" th:text="${avaliacao}"
                                                id="avaliacao-pessimo" required class="sr-only">
                                            <div class="valid-feedback">Tudo ok!</div>
                                            <div class="invalid-feedback">Avalie o atendimento!</div>
                                        </div>

                                    </div>
                                </div>

                                <!-- Observações -->
                                <div class="form-row">
                                    <!-- Observações -->
                                    <div class="col-12">
                                        <label for="observacao">Observações</label>
                                        <textarea id="observacao" name="observacao" class="form-control" rows="4"
                                            th:text="${observacao}"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /.card -->
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-12">
                        <input type="reset" value="Limpar" class="btn btn-secondary">
                        <input type="submit" value="Enviar" class="btn btn-success float-right" id="btn-enviar">
                        <!--   <button class="button">Enviar</button> -->
                    </div>
                </div>
            </form>
        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

    <div layout:fragment="scripts">
        <!-- Exibir numero e ano do BO -->
        <script th:src="@{/assets/js/exibirNumeroAnoBo.js}"></script>

        <!-- Scrip para controlar a mudança de opção na Avaliação -->
        <script th:src="@{/assets/js/setAvaliacao.js}"></script>

        <!-- Validacao de CPF -->
        <script th:src="@{/assets/js/validarCpf.js}"></script>

        <!-- Select 2 -->
        <script th:src="@{/plugins/select2/js/select2.full.min.js}"></script>
        <script>
            $(document).ready(function () {
                $('#nome_local').select2({
                    theme: 'bootstrap4'
                });
            });
        </script>

        <!-- Bootstrap 4 Validation -->
        <script>
            // Example starter JavaScript for disabling form submissions if there are invalid fields
            (function () {
                'use strict';
                window.addEventListener('load', function () {
                    // Fetch all the forms we want to apply custom Bootstrap validation styles to
                    var forms = document.getElementsByClassName('needs-validation');
                    // Loop over them and prevent submission
                    var validation = Array.prototype.filter.call(forms, function (form) {
                        form.addEventListener('submit', function (event) {
                            if (form.checkValidity() === false) {
                                event.preventDefault();
                                event.stopPropagation();
                            }
                            form.classList.add('was-validated');
                        }, false);
                    });
                }, false);
            })();            
        </script>
        <!-- <script src="http://code.jquery.com/jquery-1.9.1.js"></script> -->

        <!-- Valida Form -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
        <script>
            function validarForm(form) {
                let cpf = form.cpf.value;
                if (
                    (cpf == "" || validarCPF(cpf)) &&
                    (form.nome_local.selectedIndex != 0) &&
                    (form.nome_servico.selectedIndex != 0) &&
                    (form.periodo.selectedIndex != 0) &&
                    (form.avaliacao.value != "")
                ) {
                    return true;
                } else {
                    toastr.error("Preencha todos os campos obrigatórios!");
                    return false;
                }
            }
        </script>

    </div>

</body>

</html>